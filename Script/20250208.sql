--2025-02-08
--DELETE CASCADE Example

CREATE TABLE aa (
NO number(2),
AA1 number(5) PRIMARY KEY,
AA2 number(5) REFERENCES aa(AA1) ON DELETE CASCADE,
AA3 number(5)
);


INSERT INTO aa VALUES(1, 123, NULL, 123);
INSERT INTO aa VALUES(4, 145, 123, 121);
INSERT INTO aa VALUES(6, 121, 123, 121);
INSERT INTO aa VALUES(7, 324, 145, 324);
INSERT INTO aa VALUES(3, 345, 324, 123);
INSERT INTO aa VALUES(2, 245, NULL, 245);
INSERT INTO aa VALUES(5, 543, 245, 145);

UPDATE aa
SET AA2 = 
    CASE AA1
        WHEN 123 THEN 345
        WHEN 245 THEN 543
        ELSE AA2
    END
WHERE AA1 IN (123, 245);

commit;

DELETE FROM aa
WHERE AA1 = 345;

SELECT * FROM aa;

rollback;

DELETE FROM aa
WHERE AA1 = 121;

SELECT * FROM aa;

rollback;
